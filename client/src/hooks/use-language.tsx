import { createContext, useState, useContext, ReactNode, useEffect } from "react";

// Define available languages
export type Language = 'en' | 'fr' | 'es' | 'de' | 'zh';

// Map of languages to their display names
export const LANGUAGES = {
  'en': 'English',
  'fr': 'FranÃ§ais',
  'es': 'EspaÃ±ol',
  'de': 'Deutsch',
  'zh': 'ä¸­æ–‡'
};

// Language options with flags for the dropdown
export const LANGUAGE_OPTIONS = [
  { value: 'en' as Language, label: 'English', flag: 'ðŸ‡ºðŸ‡¸' },
  { value: 'fr' as Language, label: 'FranÃ§ais', flag: 'ðŸ‡«ðŸ‡·' },
  { value: 'es' as Language, label: 'EspaÃ±ol', flag: 'ðŸ‡ªðŸ‡¸' },
  { value: 'de' as Language, label: 'Deutsch', flag: 'ðŸ‡©ðŸ‡ª' },
  { value: 'zh' as Language, label: 'ä¸­æ–‡', flag: 'ðŸ‡¨ðŸ‡³' }
];

// Translations for the application UI
const translations = {
  en: {
    // Navigation
    dashboard: 'Dashboard',
    encryption: 'Encryption',
    decryption: 'Decryption',
    hashing: 'Hashing',
    keyGenerator: 'Key Generator',
    digitalSignature: 'Digital Signature',
    welcome: 'Welcome',
    settings: 'Settings',
    profile: 'Profile',
    logout: 'Logout',
    signIn: 'Sign In',
    login: 'Login',
    register: 'Register',
    about: 'About',
    help: 'Help',
    home: 'Home',
    logs: 'Activity Logs',
    
    // Common UI elements
    submit: 'Submit',
    cancel: 'Cancel',
    save: 'Save',
    delete: 'Delete',
    edit: 'Edit',
    copy: 'Copy',
    download: 'Download',
    loading: 'Loading...',
    search: 'Search',
    generate: 'Generate',
    selectLanguage: 'Select Language',
    changed: 'changed to',
    languageChangedDesc: 'The interface language has been updated',
    guest: 'Guest',
    notLoggedIn: 'Not logged in',
    notifications: 'Notifications',
    markAllRead: 'Mark all as read',
    noNotifications: 'No notifications',
    new: 'New',
    viewAllNotifications: 'View all notifications',
    notificationsCleared: 'Notifications cleared',
    allNotificationsRead: 'All notifications marked as read',
    loggedOut: 'Logged out',
    logoutSuccess: 'You have been logged out successfully',
    loggingOut: 'Logging out...',
    
    // Authentication
    username: 'Username',
    email: 'Email',
    password: 'Password',
    confirmPassword: 'Confirm Password',
    forgotPassword: 'Forgot Password?',
    createAccount: 'Create Account',
    loginToAccount: 'Login to your account',
    
    // Encryption components
    inputText: 'Input Text',
    encryptedText: 'Encrypted Text',
    decryptedText: 'Decrypted Text',
    selectAlgorithm: 'Select Algorithm',
    encryptBtn: 'Encrypt',
    decryptBtn: 'Decrypt',
    enterKey: 'Enter Key',
    generateKey: 'Generate Key',
    keySize: 'Key Size',
    outputFormat: 'Output Format',
    encryptionKey: 'Encryption Key',
    autoGenerate: 'Auto-generate',
    keyAutoGenerated: 'A key will be generated automatically',
    encryptingText: 'Encrypting...',
    reset: 'Reset',
    encryptionFailed: 'Encryption Failed',
    unknownError: 'Unknown error',
    unexpectedError: 'An unexpected error occurred',
    encryptionSuccessDesc: 'Your text has been encrypted',
    aesKeyHelp: 'For AES-256, enter a 32-byte key or let the system generate one.',
    uploadFile: 'Upload File',
    clear: 'Clear',
    enterTextToEncrypt: 'Enter text to encrypt',
    encryptedOutput: 'Encrypted Output',
    generatedKey: 'Generated Key (Save this securely!)',
    
    // Settings
    theme: 'Theme',
    language: 'Language',
    darkMode: 'Dark Mode',
    lightMode: 'Light Mode',
    systemTheme: 'System Theme',
    
    // Feedback messages
    successEncrypt: 'Text encrypted successfully!',
    successDecrypt: 'Text decrypted successfully!',
    successHash: 'Text hashed successfully!',
    successSignature: 'Signature created successfully!',
    copySuccess: 'Copied to clipboard',
    errorMessage: 'An error occurred',
    
    // Profile page
    accountInfo: 'Account Information',
    updateProfile: 'Update Profile',
    
    // Loading states
    loadingData: 'Loading data...',
    processingRequest: 'Processing your request...'
  },
  fr: {
    // Navigation
    dashboard: 'Tableau de Bord',
    encryption: 'Chiffrement',
    decryption: 'DÃ©chiffrement',
    hashing: 'Hachage',
    keyGenerator: 'GÃ©nÃ©rateur de ClÃ©s',
    digitalSignature: 'Signature NumÃ©rique',
    welcome: 'Bienvenue',
    settings: 'ParamÃ¨tres',
    profile: 'Profil',
    logout: 'DÃ©connexion',
    signIn: 'Se Connecter',
    login: 'Connexion',
    register: 'S\'inscrire',
    about: 'Ã€ Propos',
    help: 'Aide',
    home: 'Accueil',
    logs: 'Journaux d\'ActivitÃ©',
    
    // Common UI elements
    submit: 'Soumettre',
    cancel: 'Annuler',
    save: 'Sauvegarder',
    delete: 'Supprimer',
    edit: 'Modifier',
    copy: 'Copier',
    download: 'TÃ©lÃ©charger',
    loading: 'Chargement...',
    search: 'Rechercher',
    generate: 'GÃ©nÃ©rer',
    selectLanguage: 'SÃ©lectionner la langue',
    changed: 'changÃ©e en',
    languageChangedDesc: 'La langue de l\'interface a Ã©tÃ© mise Ã  jour',
    guest: 'InvitÃ©',
    notLoggedIn: 'Non connectÃ©',
    notifications: 'Notifications',
    markAllRead: 'Tout marquer comme lu',
    noNotifications: 'Aucune notification',
    new: 'Nouveau',
    viewAllNotifications: 'Voir toutes les notifications',
    notificationsCleared: 'Notifications effacÃ©es',
    allNotificationsRead: 'Toutes les notifications ont Ã©tÃ© marquÃ©es comme lues',
    loggedOut: 'DÃ©connectÃ©',
    logoutSuccess: 'Vous avez Ã©tÃ© dÃ©connectÃ© avec succÃ¨s',
    loggingOut: 'DÃ©connexion en cours...',
    
    // Authentication
    username: 'Nom d\'utilisateur',
    email: 'Email',
    password: 'Mot de passe',
    confirmPassword: 'Confirmer le mot de passe',
    forgotPassword: 'Mot de passe oubliÃ©?',
    createAccount: 'CrÃ©er un compte',
    loginToAccount: 'Connectez-vous Ã  votre compte',
    
    // Encryption components
    inputText: 'Texte Ã  saisir',
    encryptedText: 'Texte chiffrÃ©',
    decryptedText: 'Texte dÃ©chiffrÃ©',
    selectAlgorithm: 'SÃ©lectionner l\'algorithme',
    encryptBtn: 'Chiffrer',
    decryptBtn: 'DÃ©chiffrer',
    enterKey: 'Entrez la clÃ©',
    generateKey: 'GÃ©nÃ©rer une clÃ©',
    keySize: 'Taille de la clÃ©',
    outputFormat: 'Format de sortie',
    
    // Settings
    theme: 'ThÃ¨me',
    language: 'Langue',
    darkMode: 'Mode Sombre',
    lightMode: 'Mode Clair',
    systemTheme: 'ThÃ¨me du SystÃ¨me',
    
    // Feedback messages
    successEncrypt: 'Texte chiffrÃ© avec succÃ¨s!',
    successDecrypt: 'Texte dÃ©chiffrÃ© avec succÃ¨s!',
    successHash: 'Texte hachÃ© avec succÃ¨s!',
    successSignature: 'Signature crÃ©Ã©e avec succÃ¨s!',
    copySuccess: 'CopiÃ© dans le presse-papiers',
    errorMessage: 'Une erreur est survenue',
    
    // Profile page
    accountInfo: 'Informations du compte',
    updateProfile: 'Mettre Ã  jour le profil',
    
    // Loading states
    loadingData: 'Chargement des donnÃ©es...',
    processingRequest: 'Traitement de votre demande...'
  },
  es: {
    // Navigation
    dashboard: 'Panel',
    encryption: 'Cifrado',
    decryption: 'Descifrado',
    hashing: 'Hashing',
    keyGenerator: 'Generador de Claves',
    digitalSignature: 'Firma Digital',
    welcome: 'Bienvenido',
    settings: 'ConfiguraciÃ³n',
    profile: 'Perfil',
    logout: 'Cerrar SesiÃ³n',
    signIn: 'Iniciar SesiÃ³n',
    login: 'Acceso',
    register: 'Registrarse',
    about: 'Acerca de',
    help: 'Ayuda',
    home: 'Inicio',
    logs: 'Registros de Actividad',
    
    // Common UI elements
    submit: 'Enviar',
    cancel: 'Cancelar',
    save: 'Guardar',
    delete: 'Eliminar',
    edit: 'Editar',
    copy: 'Copiar',
    download: 'Descargar',
    loading: 'Cargando...',
    search: 'Buscar',
    generate: 'Generar',
    
    // Authentication
    username: 'Nombre de usuario',
    email: 'Correo electrÃ³nico',
    password: 'ContraseÃ±a',
    confirmPassword: 'Confirmar contraseÃ±a',
    forgotPassword: 'Â¿OlvidÃ³ su contraseÃ±a?',
    createAccount: 'Crear cuenta',
    loginToAccount: 'Inicie sesiÃ³n en su cuenta',
    
    // Encryption components
    inputText: 'Texto de entrada',
    encryptedText: 'Texto cifrado',
    decryptedText: 'Texto descifrado',
    selectAlgorithm: 'Seleccionar algoritmo',
    encryptBtn: 'Cifrar',
    decryptBtn: 'Descifrar',
    enterKey: 'Introducir clave',
    generateKey: 'Generar clave',
    keySize: 'TamaÃ±o de clave',
    outputFormat: 'Formato de salida',
    
    // Settings
    theme: 'Tema',
    language: 'Idioma',
    darkMode: 'Modo Oscuro',
    lightMode: 'Modo Claro',
    systemTheme: 'Tema del Sistema',
    
    // Feedback messages
    successEncrypt: 'Â¡Texto cifrado con Ã©xito!',
    successDecrypt: 'Â¡Texto descifrado con Ã©xito!',
    successHash: 'Â¡Texto hasheado con Ã©xito!',
    successSignature: 'Â¡Firma creada con Ã©xito!',
    copySuccess: 'Copiado al portapapeles',
    errorMessage: 'Se ha producido un error',
    
    // Profile page
    accountInfo: 'InformaciÃ³n de la cuenta',
    updateProfile: 'Actualizar perfil',
    
    // Loading states
    loadingData: 'Cargando datos...',
    processingRequest: 'Procesando su solicitud...'
  },
  de: {
    // Navigation
    dashboard: 'Dashboard',
    encryption: 'VerschlÃ¼sselung',
    decryption: 'EntschlÃ¼sselung',
    hashing: 'Hashing',
    keyGenerator: 'SchlÃ¼sselgenerator',
    digitalSignature: 'Digitale Signatur',
    welcome: 'Willkommen',
    settings: 'Einstellungen',
    profile: 'Profil',
    logout: 'Abmelden',
    signIn: 'Anmelden',
    login: 'Login',
    register: 'Registrieren',
    about: 'Ãœber',
    help: 'Hilfe',
    home: 'Startseite',
    logs: 'AktivitÃ¤tsprotokolle',
    
    // Common UI elements
    submit: 'Absenden',
    cancel: 'Abbrechen',
    save: 'Speichern',
    delete: 'LÃ¶schen',
    edit: 'Bearbeiten',
    copy: 'Kopieren',
    download: 'Herunterladen',
    loading: 'Wird geladen...',
    search: 'Suchen',
    generate: 'Generieren',
    
    // Authentication
    username: 'Benutzername',
    email: 'E-Mail',
    password: 'Passwort',
    confirmPassword: 'Passwort bestÃ¤tigen',
    forgotPassword: 'Passwort vergessen?',
    createAccount: 'Konto erstellen',
    loginToAccount: 'In Ihr Konto einloggen',
    
    // Encryption components
    inputText: 'Eingabetext',
    encryptedText: 'VerschlÃ¼sselter Text',
    decryptedText: 'EntschlÃ¼sselter Text',
    selectAlgorithm: 'Algorithmus auswÃ¤hlen',
    encryptBtn: 'VerschlÃ¼sseln',
    decryptBtn: 'EntschlÃ¼sseln',
    enterKey: 'SchlÃ¼ssel eingeben',
    generateKey: 'SchlÃ¼ssel generieren',
    keySize: 'SchlÃ¼sselgrÃ¶ÃŸe',
    outputFormat: 'Ausgabeformat',
    
    // Settings
    theme: 'Thema',
    language: 'Sprache',
    darkMode: 'Dunkelmodus',
    lightMode: 'Hellmodus',
    systemTheme: 'System-Thema',
    
    // Feedback messages
    successEncrypt: 'Text erfolgreich verschlÃ¼sselt!',
    successDecrypt: 'Text erfolgreich entschlÃ¼sselt!',
    successHash: 'Text erfolgreich gehasht!',
    successSignature: 'Signatur erfolgreich erstellt!',
    copySuccess: 'In die Zwischenablage kopiert',
    errorMessage: 'Ein Fehler ist aufgetreten',
    
    // Profile page
    accountInfo: 'Kontoinformationen',
    updateProfile: 'Profil aktualisieren',
    
    // Loading states
    loadingData: 'Daten werden geladen...',
    processingRequest: 'Ihre Anfrage wird bearbeitet...'
  },
  zh: {
    // Navigation
    dashboard: 'ä»ªè¡¨æ¿',
    encryption: 'åŠ å¯†',
    decryption: 'è§£å¯†',
    hashing: 'å“ˆå¸Œ',
    keyGenerator: 'å¯†é’¥ç”Ÿæˆå™¨',
    digitalSignature: 'æ•°å­—ç­¾å',
    welcome: 'æ¬¢è¿Ž',
    settings: 'è®¾ç½®',
    profile: 'ä¸ªäººèµ„æ–™',
    logout: 'ç™»å‡º',
    signIn: 'ç™»å½•',
    login: 'ç™»å½•',
    register: 'æ³¨å†Œ',
    about: 'å…³äºŽ',
    help: 'å¸®åŠ©',
    home: 'é¦–é¡µ',
    logs: 'æ´»åŠ¨æ—¥å¿—',
    
    // Common UI elements
    submit: 'æäº¤',
    cancel: 'å–æ¶ˆ',
    save: 'ä¿å­˜',
    delete: 'åˆ é™¤',
    edit: 'ç¼–è¾‘',
    copy: 'å¤åˆ¶',
    download: 'ä¸‹è½½',
    loading: 'åŠ è½½ä¸­...',
    search: 'æœç´¢',
    generate: 'ç”Ÿæˆ',
    
    // Authentication
    username: 'ç”¨æˆ·å',
    email: 'ç”µå­é‚®ä»¶',
    password: 'å¯†ç ',
    confirmPassword: 'ç¡®è®¤å¯†ç ',
    forgotPassword: 'å¿˜è®°å¯†ç ï¼Ÿ',
    createAccount: 'åˆ›å»ºè´¦æˆ·',
    loginToAccount: 'ç™»å½•åˆ°æ‚¨çš„è´¦æˆ·',
    
    // Encryption components
    inputText: 'è¾“å…¥æ–‡æœ¬',
    encryptedText: 'åŠ å¯†æ–‡æœ¬',
    decryptedText: 'è§£å¯†æ–‡æœ¬',
    selectAlgorithm: 'é€‰æ‹©ç®—æ³•',
    encryptBtn: 'åŠ å¯†',
    decryptBtn: 'è§£å¯†',
    enterKey: 'è¾“å…¥å¯†é’¥',
    generateKey: 'ç”Ÿæˆå¯†é’¥',
    keySize: 'å¯†é’¥å¤§å°',
    outputFormat: 'è¾“å‡ºæ ¼å¼',
    
    // Settings
    theme: 'ä¸»é¢˜',
    language: 'è¯­è¨€',
    darkMode: 'æš—è‰²æ¨¡å¼',
    lightMode: 'äº®è‰²æ¨¡å¼',
    systemTheme: 'ç³»ç»Ÿä¸»é¢˜',
    
    // Feedback messages
    successEncrypt: 'æ–‡æœ¬åŠ å¯†æˆåŠŸï¼',
    successDecrypt: 'æ–‡æœ¬è§£å¯†æˆåŠŸï¼',
    successHash: 'æ–‡æœ¬å“ˆå¸ŒæˆåŠŸï¼',
    successSignature: 'ç­¾ååˆ›å»ºæˆåŠŸï¼',
    copySuccess: 'å·²å¤åˆ¶åˆ°å‰ªè´´æ¿',
    errorMessage: 'å‘ç”Ÿé”™è¯¯',
    
    // Profile page
    accountInfo: 'è´¦æˆ·ä¿¡æ¯',
    updateProfile: 'æ›´æ–°ä¸ªäººèµ„æ–™',
    
    // Loading states
    loadingData: 'åŠ è½½æ•°æ®ä¸­...',
    processingRequest: 'æ­£åœ¨å¤„ç†æ‚¨çš„è¯·æ±‚...'
  }
};

// Context type definition
type LanguageContextType = {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
};

// Create context
const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

// Provider component
export function LanguageProvider({ children }: { children: ReactNode }) {
  // Get saved language from localStorage or default to English
  const [language, setLanguage] = useState<Language>(() => {
    const savedLang = localStorage.getItem('crypto-language');
    return (savedLang as Language) || 'en';
  });

  // Save language to localStorage when it changes
  useEffect(() => {
    localStorage.setItem('crypto-language', language);
    // Update html lang attribute for accessibility
    document.documentElement.lang = language;
  }, [language]);

  // Translation function
  const t = (key: string): string => {
    // @ts-ignore - we know our translations object structure
    return translations[language][key] || key;
  };

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

// Hook to use the language context
export function useLanguage() {
  const context = useContext(LanguageContext);
  if (context === undefined) {
    throw new Error('useLanguage must be used within a LanguageProvider');
  }
  return context;
}